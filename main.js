!function(){"use strict";class e{constructor(e,t,r,o,s){this._name=t.name,this._link=t.link,this._id=t._id,this._isLiked=t.isLiked,this._cardSelector=e,this.handleCardClick=r,this.handleCardDelete=o,this.handleCardLike=s}_handleLikeButton(){this._cardElement.querySelector(".gallery__like-button").classList.toggle("gallery__like-button_active")}toggleLike(){this._handleLikeButton()}_handleDeleteButton(){this._cardElement.remove(),this._cardElement=null}deleteCard(){this._handleDeleteButton()}getTemplate(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".gallery__card").cloneNode(!0),this._cardElement.querySelector(".gallery__title").textContent=this._name,this._cardElement.querySelector(".gallery__image").src=this._link,this._cardElement.querySelector(".gallery__image").alt=this._name,this._cardElement.id=this._id,console.log(this.items),this._isLiked&&this._cardElement.querySelector(".gallery__like-button").classList.add("gallery__like-button_active"),this._setEventListeners(),this._cardElement}_setEventListeners(){this._cardElement.querySelector(".gallery__like-button").addEventListener("click",(()=>{this.handleCardLike(this)})),this._cardElement.querySelector(".gallery__delete-button").addEventListener("click",(()=>{this.handleCardDelete(this)})),this._cardElement.querySelector(".gallery__image").addEventListener("click",(()=>{this.handleCardClick(this._name,this._link)}))}}var t=class{constructor(e,t){this._formEl=t,this._inputEl=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_setEventListeners(){this._inputEls=Array.from(this._formEl.querySelectorAll(this._inputEl)),this._submitButton=this._formEl.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}_showInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e,t){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e,t)}toggleButtonState(){let e=!1;if(this._inputEls.forEach((t=>{t.validity.valid||(e=!0)})),e)return this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0;this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}enableValidation(){this._setEventListeners(),this._formEl.addEventListener("submit",(e=>{e.preventDefault(),this.toggleButtonState()}))}};class r{constructor(e){this._modal=document.querySelector(e),this._closeButton=this._modal.querySelector(".modal__close-button")}openPopup(){this._modal.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}closePopup(){this._modal.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.closePopup()};setEventListeners(){this._modal.addEventListener("mousedown",(e=>{e.target===this._modal&&this.closePopup()})),this._closeButton.addEventListener("click",(()=>{this.closePopup()}))}}class o extends r{constructor(e,t){super(e),this._handleFormSubmit=t,this._formEl=this._modal.querySelector(".modal__form"),this._inputEls=this._formEl.querySelectorAll(".modal__input")}closePopup(){this._formEl.reset(),super.closePopup()}_getInputValues(){return this._inputValues={},this._inputEls.forEach((e=>{this._inputValues[e.name]=e.value})),this._inputValues}setEventListeners(){this._formEl.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.closePopup()})),super.setEventListeners()}}const s={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__error_visible",errorClass:"modal__error"},n=document.querySelector("#profile-edit-button"),i=document.querySelector("#profile-edit-modal"),l=(document.querySelector("#modal-edit-close-button"),document.querySelector(".profile__title")),a=document.querySelector(".profile__description"),c=document.querySelector("#profile-title-input"),d=document.querySelector("#profile-description-input"),u=(document.querySelector("#modal-edit-form"),document.querySelector(".profile__image")),h=document.querySelector("#profile-picture-modal"),m=document.querySelector(".profile__edit-image-button"),_=(document.querySelector(".modal__close-button"),document.querySelector("#profile-add-modal")),p=document.querySelector("#profile-add-button"),E=(document.querySelector("#modal-add-form"),document.querySelector("#card-title-input"),document.querySelector("#card-url-input"),document.querySelector("#modal-image-close-button"),document.querySelector(".gallery__cards"),document.querySelector(".gallery__delete-button"),document.querySelector("#confirm-modal"),document.querySelector(".modal-confirm__submit-button"),document.querySelector(".gallery__like-button"),document.querySelector(".modal").querySelector(".modal__submit-button")),b=new class{constructor(e){this.baseUrl=e}getProfileData(){return fetch(`${this.baseUrl}/v1/users/me`,{method:"GET",headers:{authorization:"177c16b7-240f-4206-a2e5-5bd359c96b1d"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>e)).catch((e=>(console.error("An error occured:",e),Promise.reject(e))))}getInitialCards(){return fetch(`${this.baseUrl}/v1/cards`,{method:"GET",headers:{authorization:"177c16b7-240f-4206-a2e5-5bd359c96b1d"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>e)).catch((e=>(console.error("An error occured:",e),Promise.reject(e))))}editProfile(e,t){return fetch(`${this.baseUrl}/v1/users/me`,{method:"PATCH",headers:{authorization:"177c16b7-240f-4206-a2e5-5bd359c96b1d","Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>e)).catch((e=>(console.error("An error occured:",e),Promise.reject(e))))}editProfilePic(e){return fetch(`${this.baseUrl}/v1/users/me/avatar`,{method:"PATCH",headers:{authorization:"177c16b7-240f-4206-a2e5-5bd359c96b1d","Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>e)).catch((e=>(console.error("An error occured:",e),Promise.reject(e))))}createNewCard(e,t){return fetch(`${this.baseUrl}/v1/cards`,{method:"POST",headers:{authorization:"177c16b7-240f-4206-a2e5-5bd359c96b1d","Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>e)).catch((e=>(console.error("An error occured:",e),Promise.reject(e))))}deleteApiCard(e){return fetch(`${this.baseUrl}/v1/cards/${e}`,{method:"DELETE",headers:{authorization:"177c16b7-240f-4206-a2e5-5bd359c96b1d","Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>e)).catch((e=>(console.error("An error occured:",e),Promise.reject(e))))}addLike(e){return fetch(`${this.baseUrl}/v1/cards/${e}/likes`,{method:"PUT",headers:{authorization:"177c16b7-240f-4206-a2e5-5bd359c96b1d"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>e)).catch((e=>(console.error("An error occured:",e),Promise.reject(e))))}removeLike(e){return fetch(`${this.baseUrl}/v1/cards/${e}/likes`,{method:"DELETE",headers:{authorization:"177c16b7-240f-4206-a2e5-5bd359c96b1d","Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>e)).catch((e=>(console.error("An error occured:",e),Promise.reject(e))))}}("https://around-api.en.tripleten-services.com"),f=new class extends r{constructor(e){super(e),this._confirmDeleteButton=this._modal.querySelector(".modal-confirm__submit-button")}handleConfirm(e){this._handleConfirmDelete=e}setEventListeners(){this._confirmDeleteButton.addEventListener("click",(()=>{this._handleConfirmDelete(),this.closePopup()})),super.setEventListeners()}}("#confirm-modal");function y(t){return new e("#card-template",t,j,(function(e){f.openPopup(),f.handleConfirm((function(){const r=t._id;b.deleteApiCard(r).then(e),e.deleteCard()}))}),(function(e){const r=t._id;!1===t.isLiked?b.addLike(r).then(e).then((()=>{e.toggleLike(),t.isLiked=!0})):b.removeLike(r).then(e).then((()=>{e.toggleLike(),t.isLiked=!1}))})).getTemplate()}f.setEventListeners();const v=new class{constructor(e,t){let{renderer:r}=e;this._renderer=r,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:e=>{const t=y(e);v.addItem(t)}},".gallery__cards");b.getInitialCards().then((e=>{v.renderItems(e.reverse())}));const S=new t(s,i);S.enableValidation(),new t(s,_).enableValidation();const g=new t(s,h);g.enableValidation();const L=new class{constructor(e,t){this._userTitle=e,this._userDescription=t}getUserInfo(){return{userTitle:this._userTitle.textContent,userDescription:this._userDescription.textContent}}setUserInfo(e){let{userTitle:t,userDescription:r}=e;this._userTitle.textContent=t,this._userDescription.textContent=r}}(l,a);function C(){E.textContent="Loading...",setTimeout((()=>{E.textContent="Save"}),1e3)}const k=new o("#profile-edit-modal",(e=>{C(),b.editProfile(e.name,e.description).then((e=>{L.setUserInfo({userTitle:e.name,userDescription:e.about})}))}));k.setEventListeners(),n.addEventListener("click",(()=>{const e=L.getUserInfo();c.value=e.userTitle,d.value=e.userDescription,S.toggleButtonState(),k.openPopup()})),b.getProfileData().then((e=>{l.textContent=e.name,a.textContent=e.about,u.src=e.avatar}));const q=new o("#profile-add-modal",(e=>{C(),b.createNewCard(e.title,e.link).then((e=>{const t=y(e);v.addItem(t)}))}));p.addEventListener("click",(()=>{q.openPopup()})),q.setEventListeners();const P=new class extends r{constructor(e){super(e),this._modalImage=this._modal.querySelector(".modal__image-preview"),this._modalImageText=this._modal.querySelector(".modal__image-text")}openPopup(e,t){this._modalImage.src=t,this._modalImage.alt=e,this._modalImageText.textContent=e,super.openPopup()}setEventListeners(){super.setEventListeners()}}("#image-modal");function j(e,t){P.openPopup(e,t)}P.setEventListeners();const B=new o("#profile-picture-modal",(e=>{C(),b.editProfilePic(e.link).then((e=>{u.src=e.avatar}))}));B.setEventListeners(),m.addEventListener("click",(()=>{g.toggleButtonState(),B.openPopup()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQWUsTUFBTUEsRUFDbkJDLFdBQUFBLENBQ0VDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBRUFDLEtBQUtDLE1BQVFMLEVBQU1NLEtBQ25CRixLQUFLRyxNQUFRUCxFQUFNUSxLQUNuQkosS0FBS0ssSUFBTVQsRUFBTVMsSUFDakJMLEtBQUtNLFNBQVdWLEVBQU1XLFFBQ3RCUCxLQUFLUSxjQUFnQmIsRUFDckJLLEtBQUtILGdCQUFrQkEsRUFDdkJHLEtBQUtGLGlCQUFtQkEsRUFDeEJFLEtBQUtELGVBQWlCQSxDQUN4QixDQUVBVSxpQkFBQUEsR0FDRVQsS0FBS1UsYUFDRkMsY0FBYyx5QkFDZEMsVUFBVUMsT0FBTyw4QkFDdEIsQ0FFQUMsVUFBQUEsR0FDRWQsS0FBS1MsbUJBQ1AsQ0FFQU0sbUJBQUFBLEdBQ0VmLEtBQUtVLGFBQWFNLFNBQ2xCaEIsS0FBS1UsYUFBZSxJQUN0QixDQUVBTyxVQUFBQSxHQUNFakIsS0FBS2UscUJBQ1AsQ0FFQUcsV0FBQUEsR0FvQkUsT0FuQkFsQixLQUFLVSxhQUFlUyxTQUNqQlIsY0FBY1gsS0FBS1EsZUFDbkJZLFFBQVFULGNBQWMsa0JBQ3RCVSxXQUFVLEdBRWJyQixLQUFLVSxhQUFhQyxjQUFjLG1CQUFtQlcsWUFBY3RCLEtBQUtDLE1BQ3RFRCxLQUFLVSxhQUFhQyxjQUFjLG1CQUFtQlksSUFBTXZCLEtBQUtHLE1BQzlESCxLQUFLVSxhQUFhQyxjQUFjLG1CQUFtQmEsSUFBTXhCLEtBQUtDLE1BQzlERCxLQUFLVSxhQUFhZSxHQUFLekIsS0FBS0ssSUFDNUJxQixRQUFRQyxJQUFJM0IsS0FBS0osT0FFYkksS0FBS00sVUFDUE4sS0FBS1UsYUFDRkMsY0FBYyx5QkFDZEMsVUFBVWdCLElBQUksK0JBR25CNUIsS0FBSzZCLHFCQUVFN0IsS0FBS1UsWUFDZCxDQUVBbUIsa0JBQUFBLEdBQ0U3QixLQUFLVSxhQUNGQyxjQUFjLHlCQUNkbUIsaUJBQWlCLFNBQVMsS0FDekI5QixLQUFLRCxlQUFlQyxLQUFLLElBRzdCQSxLQUFLVSxhQUNGQyxjQUFjLDJCQUNkbUIsaUJBQWlCLFNBQVMsS0FDekI5QixLQUFLRixpQkFBaUJFLEtBQUssSUFHL0JBLEtBQUtVLGFBQ0ZDLGNBQWMsbUJBQ2RtQixpQkFBaUIsU0FBUyxLQUN6QjlCLEtBQUtILGdCQUFnQkcsS0FBS0MsTUFBT0QsS0FBS0csTUFBTSxHQUVsRCxFQ1dGLE1BaEZBLE1BQ0VULFdBQUFBLENBQVlxQyxFQUFrQkMsR0FDNUJoQyxLQUFLaUMsUUFBVUQsRUFDZmhDLEtBQUtrQyxTQUFXSCxFQUFpQkksY0FDakNuQyxLQUFLb0Msc0JBQXdCTCxFQUFpQk0scUJBQzlDckMsS0FBS3NDLHFCQUF1QlAsRUFBaUJRLG9CQUM3Q3ZDLEtBQUt3QyxpQkFBbUJULEVBQWlCVSxnQkFDekN6QyxLQUFLMEMsWUFBY1gsRUFBaUJZLFVBQ3RDLENBR0FkLGtCQUFBQSxHQUNFN0IsS0FBSzRDLFVBQVlDLE1BQU1DLEtBQUs5QyxLQUFLaUMsUUFBUWMsaUJBQWlCL0MsS0FBS2tDLFdBQy9EbEMsS0FBS2dELGNBQWdCaEQsS0FBS2lDLFFBQVF0QixjQUFjWCxLQUFLb0MsdUJBQ3JEcEMsS0FBSzRDLFVBQVVLLFNBQVNDLElBQ3RCQSxFQUFRcEIsaUJBQWlCLFNBQVMsS0FDaEM5QixLQUFLbUQsb0JBQW9CRCxHQUN6QmxELEtBQUtvRCxtQkFBbUIsR0FDeEIsR0FFTixDQUlBQyxlQUFBQSxDQUFnQkgsR0FDZCxNQUFNSSxFQUFpQnRELEtBQUtpQyxRQUFRdEIsY0FBZSxJQUFHdUMsRUFBUXpCLFlBQzlEeUIsRUFBUXRDLFVBQVVnQixJQUFJNUIsS0FBS3dDLGtCQUMzQmMsRUFBZWhDLFlBQWM0QixFQUFRSyxrQkFDckNELEVBQWUxQyxVQUFVZ0IsSUFBSTVCLEtBQUswQyxZQUNwQyxDQUlBYyxlQUFBQSxDQUFnQk4sR0FDZCxNQUFNSSxFQUFpQnRELEtBQUtpQyxRQUFRdEIsY0FBZSxJQUFHdUMsRUFBUXpCLFlBQzlEeUIsRUFBUXRDLFVBQVVJLE9BQU9oQixLQUFLd0Msa0JBQzlCYyxFQUFlaEMsWUFBYyxHQUM3QmdDLEVBQWUxQyxVQUFVSSxPQUFPaEIsS0FBSzBDLFlBQ3ZDLENBSUFTLG1CQUFBQSxDQUFvQkQsRUFBU25CLEdBQzNCLElBQUttQixFQUFRTyxTQUFTQyxNQUNwQixPQUFPMUQsS0FBS3FELGdCQUFnQkgsR0FHOUJsRCxLQUFLd0QsZ0JBQWdCTixFQUFTbkIsRUFDaEMsQ0FJQXFCLGlCQUFBQSxHQUNFLElBQUlPLEdBQWUsRUFPbkIsR0FOQTNELEtBQUs0QyxVQUFVSyxTQUFTQyxJQUNqQkEsRUFBUU8sU0FBU0MsUUFDcEJDLEdBQWUsRUFDakIsSUFHRUEsRUFFRixPQURBM0QsS0FBS2dELGNBQWNwQyxVQUFVZ0IsSUFBSTVCLEtBQUtzQyxzQkFDOUJ0QyxLQUFLZ0QsY0FBY1ksVUFBVyxFQUd4QzVELEtBQUtnRCxjQUFjcEMsVUFBVUksT0FBT2hCLEtBQUtzQyxzQkFDekN0QyxLQUFLZ0QsY0FBY1ksVUFBVyxDQUNoQyxDQUlBQyxnQkFBQUEsR0FDRTdELEtBQUs2QixxQkFDTDdCLEtBQUtpQyxRQUFRSCxpQkFBaUIsVUFBV2dDLElBQ3ZDQSxFQUFFQyxpQkFDRi9ELEtBQUtvRCxtQkFBbUIsR0FFNUIsR0N0RmEsTUFBTVksRUFDbkJ0RSxXQUFBQSxDQUFZdUUsR0FDVmpFLEtBQUtrRSxPQUFTL0MsU0FBU1IsY0FBY3NELEdBQ3JDakUsS0FBS21FLGFBQWVuRSxLQUFLa0UsT0FBT3ZELGNBQWMsdUJBQ2hELENBRUF5RCxTQUFBQSxHQUNFcEUsS0FBS2tFLE9BQU90RCxVQUFVZ0IsSUFBSSxnQkFDMUJULFNBQVNXLGlCQUFpQixVQUFXOUIsS0FBS3FFLGdCQUM1QyxDQUVBQyxVQUFBQSxHQUNFdEUsS0FBS2tFLE9BQU90RCxVQUFVSSxPQUFPLGdCQUM3QkcsU0FBU29ELG9CQUFvQixVQUFXdkUsS0FBS3FFLGdCQUMvQyxDQUVBQSxnQkFBbUJHLElBQ0QsV0FBWkEsRUFBSUMsS0FDTnpFLEtBQUtzRSxZQUNQLEVBR0ZJLGlCQUFBQSxHQUNFMUUsS0FBS2tFLE9BQU9wQyxpQkFBaUIsYUFBYzZDLElBQ3JDQSxFQUFNQyxTQUFXNUUsS0FBS2tFLFFBQ3hCbEUsS0FBS3NFLFlBQ1AsSUFHRnRFLEtBQUttRSxhQUFhckMsaUJBQWlCLFNBQVMsS0FDMUM5QixLQUFLc0UsWUFBWSxHQUVyQixFQzlCYSxNQUFNTyxVQUFzQmIsRUFDekN0RSxXQUFBQSxDQUFZdUUsRUFBZWEsR0FDekJDLE1BQU1kLEdBQ05qRSxLQUFLZ0Ysa0JBQW9CRixFQUN6QjlFLEtBQUtpQyxRQUFVakMsS0FBS2tFLE9BQU92RCxjQUFjLGdCQUN6Q1gsS0FBSzRDLFVBQVk1QyxLQUFLaUMsUUFBUWMsaUJBQWlCLGdCQUNqRCxDQUVBdUIsVUFBQUEsR0FDRXRFLEtBQUtpQyxRQUFRZ0QsUUFDYkYsTUFBTVQsWUFDUixDQUVBWSxlQUFBQSxHQU1FLE9BTEFsRixLQUFLbUYsYUFBZSxDQUFDLEVBQ3JCbkYsS0FBSzRDLFVBQVVLLFNBQVNtQyxJQUN0QnBGLEtBQUttRixhQUFhQyxFQUFNbEYsTUFBUWtGLEVBQU1DLEtBQUssSUFHdENyRixLQUFLbUYsWUFDZCxDQUVBVCxpQkFBQUEsR0FDRTFFLEtBQUtpQyxRQUFRSCxpQkFBaUIsVUFBVzBDLElBQ3ZDQSxFQUFJVCxpQkFNSi9ELEtBQUtnRixrQkFBa0JoRixLQUFLa0YsbUJBQzVCbEYsS0FBS3NFLFlBQVksSUFHbkJTLE1BQU1MLG1CQUNSLEVDcENGLE1BQU0zQyxFQUFtQixDQUN2QnVELGFBQWMsZUFDZG5ELGNBQWUsZ0JBQ2ZFLHFCQUFzQix3QkFDdEJFLG9CQUFxQixnQ0FDckJFLGdCQUFpQix1QkFDakJFLFdBQVksZ0JDNEJENEMsRUFBb0JwRSxTQUFTUixjQUFjLHdCQUMzQzZFLEVBQW1CckUsU0FBU1IsY0FBYyx1QkFJMUM4RSxHQUh1QnRFLFNBQVNSLGNBQzNDLDRCQUUwQlEsU0FBU1IsY0FBYyxvQkFDdEMrRSxFQUFxQnZFLFNBQVNSLGNBQ3pDLHlCQUVXZ0YsRUFBb0J4RSxTQUFTUixjQUFjLHdCQUMzQ2lGLEVBQTBCekUsU0FBU1IsY0FDOUMsOEJBR1drRixHQURrQjFFLFNBQVNSLGNBQWMsb0JBQ3hCUSxTQUFTUixjQUFjLG9CQUN4Q21GLEVBQXNCM0UsU0FBU1IsY0FDMUMsMEJBRVdvRixFQUEyQjVFLFNBQVNSLGNBQy9DLCtCQU1XcUYsR0FEYzdFLFNBQVNSLGNBQWMsd0JBQ25CUSxTQUFTUixjQUFjLHVCQUN6Q3NGLEVBQW1COUUsU0FBU1IsY0FBYyx1QkF5QjFDdUYsR0F4QmlCL0UsU0FBU1IsY0FBYyxtQkFDdkJRLFNBQVNSLGNBQWMscUJBQ3pCUSxTQUFTUixjQUFjLG1CQUlkUSxTQUFTUixjQUM1Qyw2QkFLMkJRLFNBQVNSLGNBQWMsbUJBQ3BCUSxTQUFTUixjQUN2QywyQkFFNkJRLFNBQVNSLGNBQWMsa0JBQ25CUSxTQUFTUixjQUMxQyxpQ0FFMEJRLFNBQVNSLGNBQWMseUJBRTlCUSxTQUFTUixjQUFjLFVBRVZBLGNBQWMsMEJDbEMxQ3dGLEVBQVMsSUNwREEsTUFDYnpHLFdBQUFBLENBQVkwRyxHQUNWcEcsS0FBS29HLFFBQVVBLENBQ2pCLENBRUFDLGNBQUFBLEdBQ0UsT0FBT0MsTUFBTyxHQUFFdEcsS0FBS29HLHNCQUF1QixDQUMxQ0csT0FBUSxNQUNSQyxRQUFTLENBQ1BDLGNBQWUsMENBR2hCQyxNQUFNQyxHQUNBQSxFQUFJQyxHQUdGRCxFQUFJRSxPQUZGQyxRQUFRQyxPQUFRLFVBQVNKLEVBQUlLLFlBSXZDTixNQUFNTyxHQUNFQSxJQUVSQyxPQUFPQyxJQUNOekYsUUFBUXlGLE1BQU0sb0JBQXFCQSxHQUM1QkwsUUFBUUMsT0FBT0ksS0FFNUIsQ0FFQUMsZUFBQUEsR0FDRSxPQUFPZCxNQUFPLEdBQUV0RyxLQUFLb0csbUJBQW9CLENBQ3ZDRyxPQUFRLE1BQ1JDLFFBQVMsQ0FDUEMsY0FBZSwwQ0FHaEJDLE1BQU1DLEdBQ0FBLEVBQUlDLEdBR0ZELEVBQUlFLE9BRkZDLFFBQVFDLE9BQVEsVUFBU0osRUFBSUssWUFJdkNOLE1BQU1PLEdBQ0VBLElBRVJDLE9BQU9DLElBQ056RixRQUFReUYsTUFBTSxvQkFBcUJBLEdBQzVCTCxRQUFRQyxPQUFPSSxLQUU1QixDQUVBRSxXQUFBQSxDQUFZQyxFQUFhQyxHQUN2QixPQUFPakIsTUFBTyxHQUFFdEcsS0FBS29HLHNCQUF1QixDQUMxQ0csT0FBUSxRQUNSQyxRQUFTLENBQ1BDLGNBQWUsdUNBQ2YsZUFBZ0Isb0JBRWxCZSxLQUFNQyxLQUFLQyxVQUFVLENBQ25CeEgsS0FBTW9ILEVBQ05LLE1BQU9KLE1BR1JiLE1BQU1DLEdBQ0FBLEVBQUlDLEdBR0ZELEVBQUlFLE9BRkZDLFFBQVFDLE9BQVEsVUFBU0osRUFBSUssWUFJdkNOLE1BQU1PLEdBQ0VBLElBRVJDLE9BQU9DLElBQ056RixRQUFReUYsTUFBTSxvQkFBcUJBLEdBQzVCTCxRQUFRQyxPQUFPSSxLQUU1QixDQUVBUyxjQUFBQSxDQUFlQyxHQUNiLE9BQU92QixNQUFPLEdBQUV0RyxLQUFLb0csNkJBQThCLENBQ2pERyxPQUFRLFFBQ1JDLFFBQVMsQ0FDUEMsY0FBZSx1Q0FDZixlQUFnQixvQkFFbEJlLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJJLE9BQVFELE1BR1RuQixNQUFNQyxHQUNBQSxFQUFJQyxHQUdGRCxFQUFJRSxPQUZGQyxRQUFRQyxPQUFRLFVBQVNKLEVBQUlLLFlBSXZDTixNQUFNTyxHQUNFQSxJQUVSQyxPQUFPQyxJQUNOekYsUUFBUXlGLE1BQU0sb0JBQXFCQSxHQUM1QkwsUUFBUUMsT0FBT0ksS0FFNUIsQ0FFQVksYUFBQUEsQ0FBY0MsRUFBVUMsR0FDdEIsT0FBTzNCLE1BQU8sR0FBRXRHLEtBQUtvRyxtQkFBb0IsQ0FDdkNHLE9BQVEsT0FDUkMsUUFBUyxDQUNQQyxjQUFlLHVDQUNmLGVBQWdCLG9CQUVsQmUsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQnhILEtBQU04SCxFQUNONUgsS0FBTTZILE1BR1B2QixNQUFNQyxHQUNBQSxFQUFJQyxHQUdGRCxFQUFJRSxPQUZGQyxRQUFRQyxPQUFRLFVBQVNKLEVBQUlLLFlBSXZDTixNQUFNTyxHQUNFQSxJQUVSQyxPQUFPQyxJQUNOekYsUUFBUXlGLE1BQU0sb0JBQXFCQSxHQUM1QkwsUUFBUUMsT0FBT0ksS0FFNUIsQ0FFQWUsYUFBQUEsQ0FBY0MsR0FDWixPQUFPN0IsTUFBTyxHQUFFdEcsS0FBS29HLG9CQUFvQitCLElBQVUsQ0FDakQ1QixPQUFRLFNBQ1JDLFFBQVMsQ0FDUEMsY0FBZSx1Q0FDZixlQUFnQixzQkFHakJDLE1BQU1DLEdBQ0FBLEVBQUlDLEdBR0ZELEVBQUlFLE9BRkZDLFFBQVFDLE9BQVEsVUFBU0osRUFBSUssWUFJdkNOLE1BQU1PLEdBQ0VBLElBRVJDLE9BQU9DLElBQ056RixRQUFReUYsTUFBTSxvQkFBcUJBLEdBQzVCTCxRQUFRQyxPQUFPSSxLQUU1QixDQUVBaUIsT0FBQUEsQ0FBUUQsR0FDTixPQUFPN0IsTUFBTyxHQUFFdEcsS0FBS29HLG9CQUFvQitCLFVBQWdCLENBQ3ZENUIsT0FBUSxNQUNSQyxRQUFTLENBQ1BDLGNBQWUsMENBR2hCQyxNQUFNQyxHQUNBQSxFQUFJQyxHQUdGRCxFQUFJRSxPQUZGQyxRQUFRQyxPQUFRLFVBQVNKLEVBQUlLLFlBSXZDTixNQUFNTyxHQUNFQSxJQUVSQyxPQUFPQyxJQUNOekYsUUFBUXlGLE1BQU0sb0JBQXFCQSxHQUM1QkwsUUFBUUMsT0FBT0ksS0FFNUIsQ0FFQWtCLFVBQUFBLENBQVdGLEdBQ1QsT0FBTzdCLE1BQU8sR0FBRXRHLEtBQUtvRyxvQkFBb0IrQixVQUFnQixDQUN2RDVCLE9BQVEsU0FDUkMsUUFBUyxDQUNQQyxjQUFlLHVDQUNmLGVBQWdCLHNCQUdqQkMsTUFBTUMsR0FDQUEsRUFBSUMsR0FHRkQsRUFBSUUsT0FGRkMsUUFBUUMsT0FBUSxVQUFTSixFQUFJSyxZQUl2Q04sTUFBTU8sR0FDRUEsSUFFUkMsT0FBT0MsSUFDTnpGLFFBQVF5RixNQUFNLG9CQUFxQkEsR0FDNUJMLFFBQVFDLE9BQU9JLEtBRTVCLEdEakphLGdEQUlUbUIsRUFBZSxJRXBETixjQUEyQnRFLEVBQ3hDdEUsV0FBQUEsQ0FBWXVFLEdBQ1ZjLE1BQU1kLEdBQ05qRSxLQUFLdUkscUJBQXVCdkksS0FBS2tFLE9BQU92RCxjQUN0QyxnQ0FFSixDQUVBNkgsYUFBQUEsQ0FBY0MsR0FDWnpJLEtBQUswSSxxQkFBdUJELENBQzlCLENBRUEvRCxpQkFBQUEsR0FDRTFFLEtBQUt1SSxxQkFBcUJ6RyxpQkFBaUIsU0FBUyxLQUNsRDlCLEtBQUswSSx1QkFDTDFJLEtBQUtzRSxZQUFZLElBR25CUyxNQUFNTCxtQkFDUixHRmlDb0Msa0JBSXRDLFNBQVNpRSxFQUFXL0ksR0FxQ2xCLE9BcENhLElBQUlILEVBQ2YsaUJBQ0FHLEVBQ0FDLEdBQ0EsU0FBVStJLEdBQ1JOLEVBQWFsRSxZQUNia0UsRUFBYUUsZUFBYyxXQUN6QixNQUFNTCxFQUFTdkksRUFBTVMsSUFDckI4RixFQUFPK0IsY0FBY0MsR0FBUXpCLEtBQUtrQyxHQUNsQ0EsRUFBSzNILFlBQ1AsR0FDRixJQUNBLFNBQVUySCxHQUNSLE1BQU1ULEVBQVN2SSxFQUFNUyxLQUNDLElBQWxCVCxFQUFNVyxRQUNSNEYsRUFDR2lDLFFBQVFELEdBQ1J6QixLQUFLa0MsR0FDTGxDLE1BQUssS0FDSmtDLEVBQUs5SCxhQUNMbEIsRUFBTVcsU0FBVSxDQUFJLElBR3hCNEYsRUFDR2tDLFdBQVdGLEdBQ1h6QixLQUFLa0MsR0FDTGxDLE1BQUssS0FDSmtDLEVBQUs5SCxhQUNMbEIsRUFBTVcsU0FBVSxDQUFLLEdBRzdCLElBR3VCVyxhQUczQixDQXhDQW9ILEVBQWE1RCxvQkErQ2IsTUFBTW1FLEVBQWMsSUd2R0wsTUFDYm5KLFdBQUFBLENBQVdvSixFQUFlQyxHQUFtQixJQUFqQyxTQUFFQyxHQUFVRixFQUN0QjlJLEtBQUtpSixVQUFZRCxFQUNqQmhKLEtBQUtrSixXQUFhL0gsU0FBU1IsY0FBY29JLEVBQzNDLENBRUFJLFdBQUFBLENBQVl2SixHQUNWQSxFQUFNcUQsU0FBU21HLElBQ2JwSixLQUFLaUosVUFBVUcsRUFBSyxHQUV4QixDQUVBQyxPQUFBQSxDQUFRQyxHQUNOdEosS0FBS2tKLFdBQVdLLFFBQVFELEVBQzFCLEdIMEZBLENBQ0VOLFNBQVdwSixJQUNULE1BQU0wSixFQUFjWCxFQUFXL0ksR0FDL0JpSixFQUFZUSxRQUFRQyxFQUFZLEdBR3BDLG1CQUdGbkQsRUFBT2lCLGtCQUFrQlYsTUFBTU8sSUFDN0I0QixFQUFZTSxZQUFZbEMsRUFBS3VDLFVBQVUsSUFJekMsTUFBTUMsRUFBMkIsSUFBSUMsRUFDbkMzSCxFQUNBeUQsR0FHRmlFLEVBQXlCNUYsbUJBRU8sSUFBSTZGLEVBQ2xDM0gsRUFDQWlFLEdBR3NCbkMsbUJBRXhCLE1BQU04RixFQUFvQyxJQUFJRCxFQUM1QzNILEVBQ0ErRCxHQUdGNkQsRUFBa0M5RixtQkFHbEMsTUFBTStGLEVBQWMsSUk1SUwsTUFDYmxLLFdBQUFBLENBQVltSyxFQUFhQyxHQUN2QjlKLEtBQUsrSixXQUFhRixFQUNsQjdKLEtBQUtnSyxpQkFBbUJGLENBQzFCLENBRUFHLFdBQUFBLEdBSUUsTUFBTyxDQUNMQyxVQUpxQmxLLEtBQUsrSixXQUFXekksWUFLckM2SSxnQkFKMkJuSyxLQUFLZ0ssaUJBQWlCMUksWUFNckQsQ0FFQThJLFdBQUFBLENBQVd0QixHQUFpQyxJQUFoQyxVQUFFb0IsRUFBUyxnQkFBRUMsR0FBaUJyQixFQUN4QzlJLEtBQUsrSixXQUFXekksWUFBYzRJLEVBQzlCbEssS0FBS2dLLGlCQUFpQjFJLFlBQWM2SSxDQUN0QyxHSnlIK0IxRSxFQUFjQyxHQUcvQyxTQUFTMkUsSUFDUG5FLEVBQWE1RSxZQUFjLGFBQzNCZ0osWUFBVyxLQUNUcEUsRUFBYTVFLFlBQWMsTUFBTSxHQUNoQyxJQUNMLENBR0EsTUFBTWlKLEVBQW1CLElBQUkxRixFQUMzQix1QkFDQzJGLElBQ0NILElBQ0FsRSxFQUNHa0IsWUFBWW1ELEVBQVl0SyxLQUFNc0ssRUFBWUMsYUFDMUMvRCxNQUFNZ0UsSUFDTGQsRUFBWVEsWUFBWSxDQUN0QkYsVUFBV1EsRUFBZXhLLEtBQzFCaUssZ0JBQWlCTyxFQUFlL0MsT0FDaEMsR0FDRixJQUlSNEMsRUFBaUI3RixvQkFFakJhLEVBQWtCekQsaUJBQWlCLFNBQVMsS0FDMUMsTUFBTTZJLEVBQVdmLEVBQVlLLGNBQzdCdEUsRUFBa0JOLE1BQVFzRixFQUFTVCxVQUNuQ3RFLEVBQXdCUCxNQUFRc0YsRUFBU1IsZ0JBQ3pDVixFQUF5QnJHLG9CQUV6Qm1ILEVBQWlCbkcsV0FBVyxJQUc5QitCLEVBQU9FLGlCQUFpQkssTUFBTU8sSUFDNUJ4QixFQUFhbkUsWUFBYzJGLEVBQUsvRyxLQUNoQ3dGLEVBQW1CcEUsWUFBYzJGLEVBQUtVLE1BQ3RDOUIsRUFBZXRFLElBQU0wRixFQUFLYSxNQUFNLElBSWxDLE1BQU04QyxFQUFrQixJQUFJL0YsRUFDMUIsc0JBQ0MyRixJQUNDSCxJQUNBbEUsRUFDRzRCLGNBQWN5QyxFQUFZSyxNQUFPTCxFQUFZcEssTUFDN0NzRyxNQUFNb0UsSUFDTCxNQUFNeEIsRUFBY1gsRUFBV21DLEdBQy9CakMsRUFBWVEsUUFBUUMsRUFBWSxHQUNoQyxJQUlSckQsRUFBaUJuRSxpQkFBaUIsU0FBUyxLQUN6QzhJLEVBQWdCeEcsV0FBVyxJQUc3QndHLEVBQWdCbEcsb0JBR2hCLE1BQU1xRyxFQUFvQixJSzFNWCxjQUE2Qi9HLEVBQzFDdEUsV0FBQUEsQ0FBWXVFLEdBQ1ZjLE1BQU1kLEdBQ05qRSxLQUFLZ0wsWUFBY2hMLEtBQUtrRSxPQUFPdkQsY0FBYyx5QkFDN0NYLEtBQUtpTCxnQkFBa0JqTCxLQUFLa0UsT0FBT3ZELGNBQWMscUJBQ25ELENBRUF5RCxTQUFBQSxDQUFVbEUsRUFBTUUsR0FDZEosS0FBS2dMLFlBQVl6SixJQUFNbkIsRUFDdkJKLEtBQUtnTCxZQUFZeEosSUFBTXRCLEVBQ3ZCRixLQUFLaUwsZ0JBQWdCM0osWUFBY3BCLEVBQ25DNkUsTUFBTVgsV0FDUixDQUVBTSxpQkFBQUEsR0FDRUssTUFBTUwsbUJBQ1IsR0wwTDJDLGdCQUU3QyxTQUFTN0UsRUFBZ0JLLEVBQU1FLEdBQzdCMkssRUFBa0IzRyxVQUFVbEUsRUFBTUUsRUFDcEMsQ0FFQTJLLEVBQWtCckcsb0JBR2xCLE1BQU13RyxFQUEwQixJQUFJckcsRUFDbEMsMEJBQ0MyRixJQUNDSCxJQUNBbEUsRUFBT3lCLGVBQWU0QyxFQUFZcEssTUFBTXNHLE1BQU1PLElBQzVDcEIsRUFBZXRFLElBQU0wRixFQUFLYSxNQUFNLEdBQ2hDLElBSU5vRCxFQUF3QnhHLG9CQUV4QnFCLEVBQXlCakUsaUJBQWlCLFNBQVMsS0FDakQ2SCxFQUFrQ3ZHLG9CQUNsQzhILEVBQXdCOUcsV0FBVyxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvY2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL3V0aWxzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9Db25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cENvbmZpcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGl0ZW1zLFxyXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxyXG4gICAgaGFuZGxlQ2FyZERlbGV0ZSxcclxuICAgIGhhbmRsZUNhcmRMaWtlXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gaXRlbXMubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBpdGVtcy5saW5rO1xyXG4gICAgdGhpcy5faWQgPSBpdGVtcy5faWQ7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gaXRlbXMuaXNMaWtlZDtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuaGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5oYW5kbGVDYXJkRGVsZXRlID0gaGFuZGxlQ2FyZERlbGV0ZTtcclxuICAgIHRoaXMuaGFuZGxlQ2FyZExpa2UgPSBoYW5kbGVDYXJkTGlrZTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVMaWtlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fbGlrZS1idXR0b25cIilcclxuICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJnYWxsZXJ5X19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICB0b2dnbGVMaWtlKCkge1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbigpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZURlbGV0ZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUJ1dHRvbigpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X190aXRsZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2ltYWdlXCIpLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2ltYWdlXCIpLmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5pZCA9IHRoaXMuX2lkO1xyXG4gICAgY29uc29sZS5sb2codGhpcy5pdGVtcyk7XHJcblxyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAgIC5jbGFzc0xpc3QuYWRkKFwiZ2FsbGVyeV9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fbGlrZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5oYW5kbGVDYXJkTGlrZSh0aGlzKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fZGVsZXRlLWJ1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLmhhbmRsZUNhcmREZWxldGUodGhpcyk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2ltYWdlXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuaGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xyXG4gICAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiLy8gY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuLy8gICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbi8vICAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbi8vICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIsXHJcbi8vICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4vLyAgIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4vLyAgIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXHJcbi8vIH07XHJcblxyXG5jbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcih2YWxpZGF0aW9uQ29uZmlnLCBmb3JtRWwpIHtcclxuICAgIHRoaXMuX2Zvcm1FbCA9IGZvcm1FbDtcclxuICAgIHRoaXMuX2lucHV0RWwgPSB2YWxpZGF0aW9uQ29uZmlnLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHZhbGlkYXRpb25Db25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gdmFsaWRhdGlvbkNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gdmFsaWRhdGlvbkNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gdmFsaWRhdGlvbkNvbmZpZy5lcnJvckNsYXNzO1xyXG4gIH1cclxuXHJcbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFNldCBFdmVudCBMaXN0ZW5lcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dEVscyA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRFbCkpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gU2hvdyBFcnJvciAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBIaWRlIEVycm9yIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBDaGVjayBWYWxpZGl0eSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwsIHZhbGlkYXRpb25Db25maWcpIHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgfVxyXG5cclxuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFRvZ2dsZSBTdWJtaXQgQnV0dG9uIEluYWN0aXZlL0FjdGl2ZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBsZXQgZm91bmRJbnZhbGlkID0gZmFsc2U7XHJcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgIGZvdW5kSW52YWxpZCA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChmb3VuZEludmFsaWQpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHJldHVybiAodGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gRW5hYmxlL1Jlc2V0IFZhbGlkYXRpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9tb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobW9kYWxTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX21vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcclxuICB9XHJcblxyXG4gIG9wZW5Qb3B1cCgpIHtcclxuICAgIHRoaXMuX21vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZVBvcHVwKCkge1xyXG4gICAgdGhpcy5fbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2VQb3B1cCgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gdGhpcy5fbW9kYWwpIHtcclxuICAgICAgICB0aGlzLmNsb3NlUG9wdXAoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKG1vZGFsU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtRWwgPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faW5wdXRFbHMgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XHJcbiAgfVxyXG5cclxuICBjbG9zZVBvcHVwKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZVBvcHVwKCk7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dFZhbHVlcyA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5faW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9pbnB1dFZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgLy8gY29uc3Qgc3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcclxuICAgICAgLy8gc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJMb2FkaW5nLi4uXCI7XHJcbiAgICAgIC8vIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAvLyAgIHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xyXG4gICAgICAvLyB9LCAxMDAwKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCIvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIERBVEEgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5jb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JcIixcclxufTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gT1BFTi9DTE9TRSBQT1BVUCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4vKmZ1bmN0aW9uIG9wZW5Qb3B1cChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VXaXRoRXNjKTtcclxufSovXHJcblxyXG4vKlxyXG5mdW5jdGlvbiBjbG9zZVBvcHVwKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBjbG9zZVdpdGhFc2MpO1xyXG59XHJcbiovXHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gQ0xPU0UgV0lUSCBFU0MgS0VZIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuLypcclxuZnVuY3Rpb24gY2xvc2VXaXRoRXNjKGV2dCkge1xyXG4gIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICBjb25zdCBvcGVuZWRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgY2xvc2VQb3B1cChvcGVuZWRQb3B1cCk7XHJcbiAgfVxyXG59XHJcbiovXHJcblxyXG5leHBvcnQgeyB2YWxpZGF0aW9uQ29uZmlnIH07XHJcbiIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgREFUQSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmV4cG9ydCBjb25zdCBjYXJkRGF0YSA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc21pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZBUklBQkxFUyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gRURJVCBQUk9GSUxFIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XHJcbmV4cG9ydCBjb25zdCBtb2RhbEVkaXRDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjbW9kYWwtZWRpdC1jbG9zZS1idXR0b25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWVkaXQtZm9ybVwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVQaWN0dXJlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVQaWN0dXJlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtcGljdHVyZS1tb2RhbFwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdFBpY3R1cmVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGVfX2VkaXQtaW1hZ2UtYnV0dG9uXCJcclxuKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIEFERCBDQVJEIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5leHBvcnQgY29uc3QgY2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlQWRkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWRkLW1vZGFsXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWFkZC1mb3JtXCIpO1xyXG5leHBvcnQgY29uc3QgY2FyZFRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGl0bGUtaW5wdXRcIik7XHJcbmV4cG9ydCBjb25zdCBjYXJkVXJsSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdXJsLWlucHV0XCIpO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFBSRVZJRVcgQ0FSRCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbmV4cG9ydCBjb25zdCBtb2RhbEltYWdlQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI21vZGFsLWltYWdlLWNsb3NlLWJ1dHRvblwiXHJcbik7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBHUklEL0NBUkRTIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbmV4cG9ydCBjb25zdCBnYWxsZXJ5TGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19jYXJkc1wiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmREZWxldGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLmdhbGxlcnlfX2RlbGV0ZS1idXR0b25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgZGVsZXRlQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjb25maXJtLW1vZGFsXCIpO1xyXG5leHBvcnQgY29uc3QgY29uZmlybURlbGV0ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWwtY29uZmlybV9fc3VibWl0LWJ1dHRvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBjYXJkTGlrZUljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2xpa2UtYnV0dG9uXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbFwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBzdWJtaXRCdXR0b24gPSBtb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIpO1xyXG4iLCIvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU1QT1JUUyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAjQ0xBU1NFUyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9jYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwQ29uZmlybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cENvbmZpcm0uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAjVkFSSUFCTEVTIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFVUSUxTIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5pbXBvcnQgeyB2YWxpZGF0aW9uQ29uZmlnIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzLmpzXCI7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gRURJVCBQUk9GSUxFIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5pbXBvcnQge1xyXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxyXG4gIHByb2ZpbGVFZGl0TW9kYWwsXHJcbiAgcHJvZmlsZVRpdGxlLFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbixcclxuICBwcm9maWxlVGl0bGVJbnB1dCxcclxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCxcclxuICBwcm9maWxlUGljdHVyZSxcclxufSBmcm9tIFwiLi4vdXRpbHMvQ29uc3RhbnRzLmpzXCI7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBBREQgQ0FSRCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5pbXBvcnQgeyBwcm9maWxlQWRkTW9kYWwsIHByb2ZpbGVBZGRCdXR0b24gfSBmcm9tIFwiLi4vdXRpbHMvQ29uc3RhbnRzLmpzXCI7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIENIQU5HRSBQUk9GSUxFIFBJQ1RVUkUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5pbXBvcnQge1xyXG4gIHByb2ZpbGVQaWN0dXJlTW9kYWwsXHJcbiAgcHJvZmlsZUVkaXRQaWN0dXJlQnV0dG9uLFxyXG59IGZyb20gXCIuLi91dGlscy9Db25zdGFudHMuanNcIjtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIEdSSUQvQ0FSRFMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5pbXBvcnQgeyBjYXJkTGlrZUljb24gfSBmcm9tIFwiLi4vdXRpbHMvQ29uc3RhbnRzLmpzXCI7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIE1vZGFsIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5pbXBvcnQgeyBzdWJtaXRCdXR0b24gfSBmcm9tIFwiLi4vdXRpbHMvQ29uc3RhbnRzLmpzXCI7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGVU5DVElPTlMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuY29uc3QgYXBpVXJsID0gXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbVwiO1xyXG5cclxuY29uc3QgbmV3QXBpID0gbmV3IEFwaShhcGlVcmwpO1xyXG5cclxuY29uc3QgY29uZmlybVBvcHVwID0gbmV3IFBvcHVwQ29uZmlybShcIiNjb25maXJtLW1vZGFsXCIpO1xyXG5cclxuY29uZmlybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGl0ZW1zKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgaXRlbXMsXHJcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXHJcbiAgICBmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgICBjb25maXJtUG9wdXAub3BlblBvcHVwKCk7XHJcbiAgICAgIGNvbmZpcm1Qb3B1cC5oYW5kbGVDb25maXJtKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zdCBjYXJkSWQgPSBpdGVtcy5faWQ7XHJcbiAgICAgICAgbmV3QXBpLmRlbGV0ZUFwaUNhcmQoY2FyZElkKS50aGVuKGNhcmQpO1xyXG4gICAgICAgIGNhcmQuZGVsZXRlQ2FyZCgpO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgICBjb25zdCBjYXJkSWQgPSBpdGVtcy5faWQ7XHJcbiAgICAgIGlmIChpdGVtcy5pc0xpa2VkID09PSBmYWxzZSkge1xyXG4gICAgICAgIG5ld0FwaVxyXG4gICAgICAgICAgLmFkZExpa2UoY2FyZElkKVxyXG4gICAgICAgICAgLnRoZW4oY2FyZClcclxuICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgY2FyZC50b2dnbGVMaWtlKCk7XHJcbiAgICAgICAgICAgIGl0ZW1zLmlzTGlrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbmV3QXBpXHJcbiAgICAgICAgICAucmVtb3ZlTGlrZShjYXJkSWQpXHJcbiAgICAgICAgICAudGhlbihjYXJkKVxyXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLnRvZ2dsZUxpa2UoKTtcclxuICAgICAgICAgICAgaXRlbXMuaXNMaWtlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICApO1xyXG5cclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2V0VGVtcGxhdGUoKTtcclxuXHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJTlNUQU5USUFUSU5HIENMQVNTRVMgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFNFQ1RJT04gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuY29uc3QgaG9tZVNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICByZW5kZXJlcjogKGl0ZW1zKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChpdGVtcyk7XHJcbiAgICAgIGhvbWVTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIFwiLmdhbGxlcnlfX2NhcmRzXCJcclxuKTtcclxuXHJcbm5ld0FwaS5nZXRJbml0aWFsQ2FyZHMoKS50aGVuKChkYXRhKSA9PiB7XHJcbiAgaG9tZVNlY3Rpb24ucmVuZGVySXRlbXMoZGF0YS5yZXZlcnNlKCkpO1xyXG59KTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIEZPUk0gVkFMSURBVE9SIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIHZhbGlkYXRpb25Db25maWcsXHJcbiAgcHJvZmlsZUVkaXRNb2RhbFxyXG4pO1xyXG5cclxuZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IGFkZFByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgdmFsaWRhdGlvbkNvbmZpZyxcclxuICBwcm9maWxlQWRkTW9kYWxcclxuKTtcclxuXHJcbmFkZFByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IGNoYW5nZVByb2ZpbGVQaWN0dXJlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIHZhbGlkYXRpb25Db25maWcsXHJcbiAgcHJvZmlsZVBpY3R1cmVNb2RhbFxyXG4pO1xyXG5cclxuY2hhbmdlUHJvZmlsZVBpY3R1cmVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFVTRVIgSU5GTyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IHVzZXJQcm9maWxlID0gbmV3IFVzZXJJbmZvKHByb2ZpbGVUaXRsZSwgcHJvZmlsZURlc2NyaXB0aW9uKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAjTU9EQUxTIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuZnVuY3Rpb24gQnV0dG9uTG9hZGluZygpIHtcclxuICBzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIkxvYWRpbmcuLi5cIjtcclxuICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgIHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xyXG4gIH0sIDEwMDApO1xyXG59XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIEVESVQgUFJPRklMRSBNT0RBTC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG4gIChpbnB1dFZhbHVlcykgPT4ge1xyXG4gICAgQnV0dG9uTG9hZGluZygpO1xyXG4gICAgbmV3QXBpXHJcbiAgICAgIC5lZGl0UHJvZmlsZShpbnB1dFZhbHVlcy5uYW1lLCBpbnB1dFZhbHVlcy5kZXNjcmlwdGlvbilcclxuICAgICAgLnRoZW4oKG5ld1Byb2ZpbGVEYXRhKSA9PiB7XHJcbiAgICAgICAgdXNlclByb2ZpbGUuc2V0VXNlckluZm8oe1xyXG4gICAgICAgICAgdXNlclRpdGxlOiBuZXdQcm9maWxlRGF0YS5uYW1lLFxyXG4gICAgICAgICAgdXNlckRlc2NyaXB0aW9uOiBuZXdQcm9maWxlRGF0YS5hYm91dCxcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG4pO1xyXG5cclxuZWRpdFByb2ZpbGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCB1c2VySW5mbyA9IHVzZXJQcm9maWxlLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSB1c2VySW5mby51c2VyVGl0bGU7XHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSB1c2VySW5mby51c2VyRGVzY3JpcHRpb247XHJcbiAgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gIGVkaXRQcm9maWxlTW9kYWwub3BlblBvcHVwKCk7XHJcbn0pO1xyXG5cclxubmV3QXBpLmdldFByb2ZpbGVEYXRhKCkudGhlbigoZGF0YSkgPT4ge1xyXG4gIHByb2ZpbGVUaXRsZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xyXG4gIHByb2ZpbGVQaWN0dXJlLnNyYyA9IGRhdGEuYXZhdGFyO1xyXG59KTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIEFERCBDQVJEIE1PREFMIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuY29uc3QgYWRkUHJvZmlsZU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjcHJvZmlsZS1hZGQtbW9kYWxcIixcclxuICAoaW5wdXRWYWx1ZXMpID0+IHtcclxuICAgIEJ1dHRvbkxvYWRpbmcoKTtcclxuICAgIG5ld0FwaVxyXG4gICAgICAuY3JlYXRlTmV3Q2FyZChpbnB1dFZhbHVlcy50aXRsZSwgaW5wdXRWYWx1ZXMubGluaylcclxuICAgICAgLnRoZW4oKG5ld0NhcmREYXRhKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKG5ld0NhcmREYXRhKTtcclxuICAgICAgICBob21lU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG4pO1xyXG5cclxucHJvZmlsZUFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGFkZFByb2ZpbGVNb2RhbC5vcGVuUG9wdXAoKTtcclxufSk7XHJcblxyXG5hZGRQcm9maWxlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gSU1BR0UgUFJFVklFVyBNT0RBTCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuY29uc3QgaW1hZ2VQcmV2aWV3TW9kYWwgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1hZ2UtbW9kYWxcIik7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDYXJkQ2xpY2sobmFtZSwgbGluaykge1xyXG4gIGltYWdlUHJldmlld01vZGFsLm9wZW5Qb3B1cChuYW1lLCBsaW5rKTtcclxufVxyXG5cclxuaW1hZ2VQcmV2aWV3TW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIEVESVQgUFJPRklMRSBQSUNUVVJFIE1PREFMIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IGVkaXRQcm9maWxlUGljdHVyZU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjcHJvZmlsZS1waWN0dXJlLW1vZGFsXCIsXHJcbiAgKGlucHV0VmFsdWVzKSA9PiB7XHJcbiAgICBCdXR0b25Mb2FkaW5nKCk7XHJcbiAgICBuZXdBcGkuZWRpdFByb2ZpbGVQaWMoaW5wdXRWYWx1ZXMubGluaykudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBwcm9maWxlUGljdHVyZS5zcmMgPSBkYXRhLmF2YXRhcjtcclxuICAgIH0pO1xyXG4gIH1cclxuKTtcclxuXHJcbmVkaXRQcm9maWxlUGljdHVyZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5wcm9maWxlRWRpdFBpY3R1cmVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjaGFuZ2VQcm9maWxlUGljdHVyZUZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICBlZGl0UHJvZmlsZVBpY3R1cmVNb2RhbC5vcGVuUG9wdXAoKTtcclxufSk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gWCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKGJhc2VVcmwpIHtcclxuICAgIHRoaXMuYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgfVxyXG5cclxuICBnZXRQcm9maWxlRGF0YSgpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3YxL3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBcIjE3N2MxNmI3LTI0MGYtNDIwNi1hMmU1LTViZDM1OWM5NmIxZFwiLFxyXG4gICAgICB9LFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmICghcmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkFuIGVycm9yIG9jY3VyZWQ6XCIsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3YxL2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBcIjE3N2MxNmI3LTI0MGYtNDIwNi1hMmU1LTViZDM1OWM5NmIxZFwiLFxyXG4gICAgICB9LFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmICghcmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkFuIGVycm9yIG9jY3VyZWQ6XCIsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGVkaXRQcm9maWxlKHByb2ZpbGVOYW1lLCBwcm9maWxlQWJvdXQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3YxL3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiMTc3YzE2YjctMjQwZi00MjA2LWEyZTUtNWJkMzU5Yzk2YjFkXCIsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBwcm9maWxlTmFtZSxcclxuICAgICAgICBhYm91dDogcHJvZmlsZUFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAoIXJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJBbiBlcnJvciBvY2N1cmVkOlwiLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBlZGl0UHJvZmlsZVBpYyhuZXdBdmF0YXIpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3YxL3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBcIjE3N2MxNmI3LTI0MGYtNDIwNi1hMmU1LTViZDM1OWM5NmIxZFwiLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBuZXdBdmF0YXIsXHJcbiAgICAgIH0pLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmICghcmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkFuIGVycm9yIG9jY3VyZWQ6XCIsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGNyZWF0ZU5ld0NhcmQoY2FyZE5hbWUsIGNhcmRMaW5rKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS92MS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiMTc3YzE2YjctMjQwZi00MjA2LWEyZTUtNWJkMzU5Yzk2YjFkXCIsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBjYXJkTmFtZSxcclxuICAgICAgICBsaW5rOiBjYXJkTGluayxcclxuICAgICAgfSksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKCFyZXMub2spIHtcclxuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiQW4gZXJyb3Igb2NjdXJlZDpcIiwgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQXBpQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3YxL2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCIxNzdjMTZiNy0yNDBmLTQyMDYtYTJlNS01YmQzNTljOTZiMWRcIixcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAoIXJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJBbiBlcnJvciBvY2N1cmVkOlwiLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRMaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdjEvY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBcIjE3N2MxNmI3LTI0MGYtNDIwNi1hMmU1LTViZDM1OWM5NmIxZFwiLFxyXG4gICAgICB9LFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmICghcmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkFuIGVycm9yIG9jY3VyZWQ6XCIsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUxpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS92MS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiMTc3YzE2YjctMjQwZi00MjA2LWEyZTUtNWJkMzU5Yzk2YjFkXCIsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKCFyZXMub2spIHtcclxuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiQW4gZXJyb3Igb2NjdXJlZDpcIiwgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwQ29uZmlybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihtb2RhbFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2NvbmZpcm1EZWxldGVCdXR0b24gPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5tb2RhbC1jb25maXJtX19zdWJtaXQtYnV0dG9uXCJcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVDb25maXJtKGFjdGlvbikge1xyXG4gICAgdGhpcy5faGFuZGxlQ29uZmlybURlbGV0ZSA9IGFjdGlvbjtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY29uZmlybURlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVDb25maXJtRGVsZXRlKCk7XHJcbiAgICAgIHRoaXMuY2xvc2VQb3B1cCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oY2FyZEVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGNhcmRFbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHVzZXJUaXRsZUVsLCB1c2VyRGVzY3JpcHRpb25FbCkge1xyXG4gICAgdGhpcy5fdXNlclRpdGxlID0gdXNlclRpdGxlRWw7XHJcbiAgICB0aGlzLl91c2VyRGVzY3JpcHRpb24gPSB1c2VyRGVzY3JpcHRpb25FbDtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgY29uc3QgdXNlclRpdGxlVmFsdWUgPSB0aGlzLl91c2VyVGl0bGUudGV4dENvbnRlbnQ7XHJcbiAgICBjb25zdCB1c2VyRGVzY3JpcHRpb25WYWx1ZSA9IHRoaXMuX3VzZXJEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB1c2VyVGl0bGU6IHVzZXJUaXRsZVZhbHVlLFxyXG4gICAgICB1c2VyRGVzY3JpcHRpb246IHVzZXJEZXNjcmlwdGlvblZhbHVlLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgdXNlclRpdGxlLCB1c2VyRGVzY3JpcHRpb24gfSkge1xyXG4gICAgdGhpcy5fdXNlclRpdGxlLnRleHRDb250ZW50ID0gdXNlclRpdGxlO1xyXG4gICAgdGhpcy5fdXNlckRlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdXNlckRlc2NyaXB0aW9uO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKG1vZGFsU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fbW9kYWxJbWFnZSA9IHRoaXMuX21vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlLXByZXZpZXdcIik7XHJcbiAgICB0aGlzLl9tb2RhbEltYWdlVGV4dCA9IHRoaXMuX21vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlLXRleHRcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuUG9wdXAobmFtZSwgbGluaykge1xyXG4gICAgdGhpcy5fbW9kYWxJbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5fbW9kYWxJbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fbW9kYWxJbWFnZVRleHQudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgc3VwZXIub3BlblBvcHVwKCk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJjYXJkU2VsZWN0b3IiLCJpdGVtcyIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUNhcmREZWxldGUiLCJoYW5kbGVDYXJkTGlrZSIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUxpa2VCdXR0b24iLCJfY2FyZEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwidG9nZ2xlTGlrZSIsIl9oYW5kbGVEZWxldGVCdXR0b24iLCJyZW1vdmUiLCJkZWxldGVDYXJkIiwiZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJ0ZXh0Q29udGVudCIsInNyYyIsImFsdCIsImlkIiwiY29uc29sZSIsImxvZyIsImFkZCIsIl9zZXRFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJ2YWxpZGF0aW9uQ29uZmlnIiwiZm9ybUVsIiwiX2Zvcm1FbCIsIl9pbnB1dEVsIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9pbnB1dEVscyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwiZm9yRWFjaCIsImlucHV0RWwiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvck1lc3NhZ2VFbCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwidmFsaWRpdHkiLCJ2YWxpZCIsImZvdW5kSW52YWxpZCIsImRpc2FibGVkIiwiZW5hYmxlVmFsaWRhdGlvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsIlBvcHVwIiwibW9kYWxTZWxlY3RvciIsIl9tb2RhbCIsIl9jbG9zZUJ1dHRvbiIsIm9wZW5Qb3B1cCIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlUG9wdXAiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJldmVudCIsInRhcmdldCIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsInJlc2V0IiwiX2dldElucHV0VmFsdWVzIiwiX2lucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsImZvcm1TZWxlY3RvciIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUVkaXRNb2RhbCIsInByb2ZpbGVUaXRsZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJwcm9maWxlUGljdHVyZSIsInByb2ZpbGVQaWN0dXJlTW9kYWwiLCJwcm9maWxlRWRpdFBpY3R1cmVCdXR0b24iLCJwcm9maWxlQWRkTW9kYWwiLCJwcm9maWxlQWRkQnV0dG9uIiwic3VibWl0QnV0dG9uIiwibmV3QXBpIiwiYmFzZVVybCIsImdldFByb2ZpbGVEYXRhIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZGF0YSIsImNhdGNoIiwiZXJyb3IiLCJnZXRJbml0aWFsQ2FyZHMiLCJlZGl0UHJvZmlsZSIsInByb2ZpbGVOYW1lIiwicHJvZmlsZUFib3V0IiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImVkaXRQcm9maWxlUGljIiwibmV3QXZhdGFyIiwiYXZhdGFyIiwiY3JlYXRlTmV3Q2FyZCIsImNhcmROYW1lIiwiY2FyZExpbmsiLCJkZWxldGVBcGlDYXJkIiwiY2FyZElkIiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJjb25maXJtUG9wdXAiLCJfY29uZmlybURlbGV0ZUJ1dHRvbiIsImhhbmRsZUNvbmZpcm0iLCJhY3Rpb24iLCJfaGFuZGxlQ29uZmlybURlbGV0ZSIsImNyZWF0ZUNhcmQiLCJjYXJkIiwiaG9tZVNlY3Rpb24iLCJfcmVmIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwiY2FyZEVsZW1lbnQiLCJwcmVwZW5kIiwicmV2ZXJzZSIsImVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJjaGFuZ2VQcm9maWxlUGljdHVyZUZvcm1WYWxpZGF0b3IiLCJ1c2VyUHJvZmlsZSIsInVzZXJUaXRsZUVsIiwidXNlckRlc2NyaXB0aW9uRWwiLCJfdXNlclRpdGxlIiwiX3VzZXJEZXNjcmlwdGlvbiIsImdldFVzZXJJbmZvIiwidXNlclRpdGxlIiwidXNlckRlc2NyaXB0aW9uIiwic2V0VXNlckluZm8iLCJCdXR0b25Mb2FkaW5nIiwic2V0VGltZW91dCIsImVkaXRQcm9maWxlTW9kYWwiLCJpbnB1dFZhbHVlcyIsImRlc2NyaXB0aW9uIiwibmV3UHJvZmlsZURhdGEiLCJ1c2VySW5mbyIsImFkZFByb2ZpbGVNb2RhbCIsInRpdGxlIiwibmV3Q2FyZERhdGEiLCJpbWFnZVByZXZpZXdNb2RhbCIsIl9tb2RhbEltYWdlIiwiX21vZGFsSW1hZ2VUZXh0IiwiZWRpdFByb2ZpbGVQaWN0dXJlTW9kYWwiXSwic291cmNlUm9vdCI6IiJ9